<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–≤–∏–∑ –ø–æ –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏</title>
    <style>
        body {
            font-family: 'Onest', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 0; 
            min-height: 100vh;
            box-sizing: border-box;
            color: white; 
            background: linear-gradient(170.3deg, #BE0773 3.42%, #2B40E8 50.95%, #00A3FF 97.51%);
            background-attachment: fixed; 
        }

        .header-container {
            text-align: center;
            margin-top: 35px;
            /* margin-bottom –¥–ª—è –æ—Ç—Å—Ç—É–ø–∞ –¥–æ —Å–µ—Ç–∫–∏ —Ç–µ–ø–µ—Ä—å —É subtitle */
            padding: 0 20px; 
        }

        .logo {
            width: 150px; 
            height: auto;
            margin-bottom: 20px; 
        }
        
        .main-title {
            font-family: 'Onest', sans-serif;
            font-weight: 600;
            font-size: 28px;
            line-height: 99%; 
            letter-spacing: 0%;
            text-align: center;
            color: white;
            margin-top: 0; /* –£–±—Ä–∞–ª –≤–µ—Ä—Ö–Ω–∏–π, —á—Ç–æ–±—ã –ª–æ–≥–æ—Ç–∏–ø –±—ã–ª –≥–ª–∞–≤–Ω—ã–º –ø–æ –æ—Ç—Å—Ç—É–ø—É */
            margin-bottom: 15px; 
        }

        .subtitle {
            font-family: 'Onest', sans-serif;
            font-weight: 400;
            font-size: 16px;
            line-height: 110%;
            letter-spacing: 0%;
            text-align: center;
            color: white;
            max-width: 600px; 
            margin: 0 auto 26px auto; /* –û—Ç—Å—Ç—É–ø –≤–Ω–∏–∑ 26px –¥–æ game-container (—Å–µ—Ç–∫–∏) */
        }

        /* #game-container —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ */
        #game-container {
            display: flex;
            /* gap —É–±—Ä–∞–Ω, –±—É–¥–µ–º —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –º–µ–∂–¥—É grid –∏ questions —á–µ—Ä–µ–∑ margin/padding –∏–ª–∏ gap –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö flex-–¥–µ—Ç–µ–π */
            flex-wrap: wrap; /* –ü–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è –Ω–∞ –æ—á–µ–Ω—å —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö –¥–æ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å–∞ */
            width: auto;
            max-width: calc(100% - 40px); 
            align-items: flex-start; /* –í–∞–∂–Ω–æ –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–∑–Ω–æ–π –≤—ã—Å–æ—Ç—ã */
            justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç, –µ—Å–ª–∏ –æ–Ω –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é —à–∏—Ä–∏–Ω—É */
            margin-bottom: 30px; 
            /* –£–±—Ä–∞–Ω—ã: background-color, padding, border-radius, box-shadow */
        }

        #grid-container {
            user-select: none;
            overflow: auto; 
            /* max-width: 100%; -- –Ω–µ –Ω—É–∂–Ω–æ, —Ç.–∫. #game-container —É–∂–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç */
            margin-right: 20px; /* –û—Ç—Å—Ç—É–ø –æ—Ç —Å–µ—Ç–∫–∏ –¥–æ —Å–ø–∏—Å–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ */
        }
        /* –ï—Å–ª–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –æ–Ω–∏ –≤ —Å—Ç–æ–ª–±–∏–∫, —ç—Ç–æ—Ç margin-right –Ω–µ –Ω—É–∂–µ–Ω, –Ω—É–∂–µ–Ω margin-bottom */


        #letter-grid {
            border-collapse: collapse;
            margin: 0 auto; 
        }

        #letter-grid td {
            width: 30px; 
            height: 30px;
            border: 1px solid white; 
            text-align: center;
            font-size: 16px; 
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
            background-color: rgba(255, 255, 255, 0.15); 
            color: white; 
        }

        #letter-grid td.selected {
            background-color: rgba(255, 255, 255, 0.4); 
            color: #2B40E8; 
        }

        #letter-grid td.found {
            background-color: #28a745; 
            color: white; 
            font-weight: bold;
        }
        
        #letter-grid td.found.selected {
            background-color: rgba(255, 255, 255, 0.4); 
            color: #2B40E8; 
        }

        #questions-container {
            max-width: 400px; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã —Å–ø–∏—Å–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ */
            min-width: 300px; 
            display: flex;
            flex-direction: column;
            /* background-color: rgba(0,0,0,0.1); /* –õ–µ–≥–∫–∏–π —Ñ–æ–Ω –¥–ª—è –±–ª–æ–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤, —á—Ç–æ–±—ã –≤–∏–∑—É–∞–ª—å–Ω–æ –æ—Ç–¥–µ–ª–∏—Ç—å */
            /* padding: 15px; */
            /* border-radius: 8px; */
        }
        
        #questions-container h2 { 
            font-family: 'Onest', sans-serif;
            font-weight: 600; 
            font-size: 22px;
            color: white;
            text-align: center;
            margin-top: 0; 
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        #questions-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #questions-list li {
            padding: 10px 5px; 
            border-bottom: 1px solid rgba(255,255,255,0.2); 
            font-family: 'Onest', sans-serif;
            font-weight: 500;
            font-size: 18px;
            line-height: 120%;
            text-indent: 10px;
            letter-spacing: 0%;
            color: white; 
            transition: color 0.3s ease, background-color 0.3s ease;
        }
         #questions-list li.not-placed {
            opacity: 0.6; 
            font-style: italic;
        }
        
        #questions-list li:last-child {
            border-bottom: none;
        }

        #questions-list li.question-found {
            color: #90ee90; 
            text-decoration: line-through;
            font-weight: bold;
            background-color: rgba(40, 167, 69, 0.3); 
        }
        
        #win-message {
            text-align: center;
            font-size: 24px;
            color: #90ee90; 
            margin: 20px;
            background-color: rgba(0,0,0,0.3); 
            padding: 20px;
            border-radius: 8px;
        }
        #restart-button-container {
            text-align: center;
            margin-top: 15px;
        }
        #restart-button {
            padding: 12px 25px;
            font-size: 18px;
            font-family: 'Onest', sans-serif;
            font-weight: 600;
            color: #2B40E8; 
            background-color: white; 
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        #restart-button:hover {
            background-color: #f0f0f0;
            transform: scale(1.05);
        }

        .footer {
            width: 100%;
            max-width: 800px; 
            margin: 0px auto 20px auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            box-sizing: border-box;
        }

        .footer-link, .footer-tg {
            font-family: 'Onest', sans-serif;
            font-weight: 400;
            font-size: 16px;
            line-height: 110%;
            letter-spacing: 0%;
            color: white;
        }
        .footer-link a, .footer-tg a {
            color: white;
            text-decoration: underline;
            text-decoration-style: solid;
            text-underline-offset: 3px; 
        }
         .footer-tg .tg-prefix {
            text-decoration: none; 
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            body { padding: 0; }
            .header-container { margin-top: 25px; margin-bottom: 0; } /* –£–±—Ä–∞–ª–∏ –Ω–∏–∂–Ω–∏–π –æ—Ç—Å—Ç—É–ø, —Ç.–∫. –æ–Ω —É .subtitle */

            #game-container { 
                flex-direction: column; 
                align-items: center; 
                gap: 20px; /* –¢–µ–ø–µ—Ä—å gap –∑–¥–µ—Å—å –¥–ª—è –æ—Ç—Å—Ç—É–ø–∞ –º–µ–∂–¥—É —Å–µ—Ç–∫–æ–π –∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏, –∫–æ–≥–¥–∞ –æ–Ω–∏ –≤ —Å—Ç–æ–ª–±–∏–∫ */
                padding: 0 10px; /* –£–º–µ–Ω—å—à–∞–µ–º –±–æ–∫–æ–≤—ã–µ –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–≥—Ä—ã */
                max-width: 100%;
                margin-left: 0;
                margin-right: 0;
                box-sizing: border-box;
            }
            #grid-container { 
                width: 100%; /* –ß—Ç–æ–±—ã —Å–µ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–ª–∞ –¥–æ—Å—Ç—É–ø–Ω—É—é —à–∏—Ä–∏–Ω—É –∏ —Å–∫—Ä–æ–ª–ª–∏–ª–∞—Å—å –µ—Å–ª–∏ –Ω–∞–¥–æ */
                margin-right: 0; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–∞–≤—ã–π –æ—Ç—Å—Ç—É–ø –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
                /* margin-bottom: 20px; -- —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ gap —É —Ä–æ–¥–∏—Ç–µ–ª—è */
            }
            /* #letter-grid td —Å—Ç–∏–ª–∏ —à—Ä–∏—Ñ—Ç–∞/—Ü–≤–µ—Ç–∞ –æ—Å—Ç–∞—é—Ç—Å—è, —Ä–∞–∑–º–µ—Ä —è—á–µ–π–∫–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å 28px –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º */
             #letter-grid td { 
                 width: calc((100vw - 40px - (var(--grid-cols, 10) - 1) * 1px) / var(--grid-cols, 10) ); /* –ü–æ–ø—ã—Ç–∫–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —è—á–µ–π–∫–∏ */
                 height: calc((100vw - 40px - (var(--grid-cols, 10) - 1) * 1px) / var(--grid-cols, 10) );
                 max-width: 35px; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —è—á–µ–π–∫–∏ */
                 max-height: 35px;
                 min-width: 24px; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —è—á–µ–π–∫–∏ */
                 min-height: 24px;
                 font-size: 14px; /* –®—Ä–∏—Ñ—Ç —è—á–µ–µ–∫ –æ—Å—Ç–∞–µ—Ç—Å—è */
            }


            #questions-container { 
                max-width: 100%; 
                width: 100%; 
                min-width: unset; 
                margin-top: 0; /* –û—Ç—Å—Ç—É–ø —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è gap —É #game-container */
            }
            
            #win-message { font-size: 20px; } /* –°—Ç–∏–ª–∏ —à—Ä–∏—Ñ—Ç–∞ –æ—Å—Ç–∞—é—Ç—Å—è */
        }
    </style>
</head>
<body>
    <div class="header-container">
        <img src="https://ai-pets-avatars.s3.us-east-1.amazonaws.com/usermodels/qapp-quizz-logo.svg" alt="QAPP Quiz Logo" class="logo">
        <h1 class="main-title">–ö–≤–∏–∑ –ø–æ –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h1>
        <p class="subtitle">–ù–∞–π–¥–∏ 5 —Å–ª–æ–≤ –≤ —Å–µ—Ç–∫–µ, –æ—Ç–≤–µ—á–∞—è –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã-–ø–æ–¥—Å–∫–∞–∑–∫–∏, –∏ –ø–æ–ª—É—á–∏ –≤–∫—É—Å–Ω—ã–π –ø—Ä–∏–∑! üç¨</p>
    </div>
    
    <div id="game-container">
        <div id="grid-container">
            <table id="letter-grid"></table>
        </div>
        <div id="questions-container">
            <h2></h2>
            <ul id="questions-list"></ul>
        </div>
    </div>

    <div id="win-message" style="display:none;">
        –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –Ω–∞—à–ª–∏ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ–≤–∞!
        <div id="restart-button-container">
            <button id="restart-button">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-link">
            <a href="https://qapp.tech/" target="_blank">qapp.tech</a>
        </div>
        <div class="footer-tg">
            <span class="tg-prefix">tg:</span> <a href="https://t.me/qapptech" target="_blank">@qapptech</a>
        </div>
    </footer>

    <script>
        // –í–ê–ñ–ù–û: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–ª–æ–≤–∞ –¥–ª–∏–Ω–Ω–µ–µ 10 –±—É–∫–≤ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ —ç—Ç–∏—Ö —Å–ø–∏—Å–∫–æ–≤.
        const SIMPLE_QA_RAW = [
            { q: "–ü—Ä–æ–µ–∫—Ç –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≠–¶–ü –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏", a: "–ì–∏–ø–µ—Ä–∏–∫—É–º" }, // 9
            { q: "–®–∏—Ñ—Ä–æ–≤–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞, –∫–æ—Ç–æ—Ä—É—é –≤–∑–ª–æ–º–∞–ª –ê–ª–∞–Ω –¢—å—é—Ä–∏–Ω–≥", a: "–≠–Ω–∏–≥–º–∞" }, // 6
            { q: "–°–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞ –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ö—ç—à", a: "–ö–æ–ª–ª–∏–∑–∏—è" }, // 8
            { q: "–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è", a: "–ö—É–∑–Ω–µ—á–∏–∫" }, // 8
            { q: "–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è", a: "–ú–∞–≥–º–∞" },   // 5
            { q: "–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è", a: "–°—Ç—Ä–∏–±–æ–≥" }, // 7
            { q: "–°–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –∫ –ø–∞—Ä–æ–ª—é –ø–µ—Ä–µ–¥ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º", a: "–°–æ–ª—å" },    // 4
            { q: "–ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º", a: "–ë–∏–æ–º–µ—Ç—Ä–∏—è" }, // 9
            { q: "–ú–µ—Ç–æ–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è", a: "–ü–æ–¥–ø–∏—Å—å" }, // 7
            { q: "–§–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏", a: "–¢–æ–∫–µ–Ω" },   // 5
            { q: "–¶–µ–ø–æ—á–∫–∞ –±–ª–æ–∫–æ–≤ —Å –∑–∞—â–∏—â–µ–Ω–Ω—ã–º–∏ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–π", a: "–ë–ª–æ–∫—á–µ–π–Ω" },// 9
            { q: "–°–µ–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø–æ–¥–ø–∏—Å–∏", a: "–ö–ª—é—á" },    // 4
            { q: "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è", a: "–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ" },// 10
            { q: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö", a: "–®–∏—Ñ—Ä–∞—Ç–æ—Ä" }, // 8
            { q: "–°–µ–∫—Ä–µ—Ç–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –¥–∞–Ω–Ω—ã–º", a: "–ü–∞—Ä–æ–ª—å" }  // 6
        ];

        const COMPLEX_QA_RAW = [
            { q: "–û–±–ª–∞—Å—Ç—å –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∫ –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç Kyber/ML-KEM", a: "–†–µ—à–µ—Ç–∫–∏" }, // 7
            { q: "–û–±–ª–∞—Å—Ç—å –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∫ –∫–æ—Ç–æ—Ä–æ–π –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º–∞ –ú–∞–∫-–≠–ª–∏—Å–∞", a: "–ö–æ–¥—ã" }, // 4
            { q: "–§–∞–º–∏–ª–∏—è –∞–≤—Ç–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–ª—è –≤–∑–ª–æ–º–∞ RSA —Å –ø–æ–º–æ—â—å—é –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞", a: "–®–æ—Ä" }, // 3
            { q: "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –¥–∞—é—â–∏–π –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∞—Ç–∞–∫–∏ –ø–µ—Ä–µ–±–æ—Ä–æ–º", a: "–ì—Ä–æ–≤–µ—Ä" }, // 6
            { q: "–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—â–∞—è –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä–æ–∫—É —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã", a: "–•—ç—à" } // 3
        ];

        const NUM_SIMPLE_QUESTIONS = 4;
        const NUM_COMPLEX_QUESTIONS = 1;
        const MIN_GRID_DIMENSION = 10; 
        const MAX_GRID_DIMENSION = 12; 
        const MAX_PLACEMENT_ATTEMPTS_PER_WORD = 250; 

        let CURRENT_QUIZ_QA_LIST = []; 
        let GRID_ROWS = MIN_GRID_DIMENSION;
        let GRID_COLS = MIN_GRID_DIMENSION;

        let grid = []; 
        let selectedCells = []; 
        let placedWordsData = []; 

        const alphabet = "–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø";

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function selectQuizQuestions() {
            const activeSimpleQA = SIMPLE_QA_RAW.filter(qa => qa.a && qa.a.length <= 10);
            const activeComplexQA = COMPLEX_QA_RAW.filter(qa => qa.a && qa.a.length <= 10);

            if (activeSimpleQA.length < NUM_SIMPLE_QUESTIONS) {
                console.error(`Not enough active simple questions (<=10 letters) (need ${NUM_SIMPLE_QUESTIONS}, have ${activeSimpleQA.length})`);
                alert("–û—à–∏–±–∫–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (–¥–ª–∏–Ω–æ–π –¥–æ 10 –±—É–∫–≤) –¥–ª—è –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã.");
                return false;
            }
            if (activeComplexQA.length < NUM_COMPLEX_QUESTIONS) {
                console.error(`Not enough active complex questions (<=10 letters) (need ${NUM_COMPLEX_QUESTIONS}, have ${activeComplexQA.length})`);
                alert("–û—à–∏–±–∫–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (–¥–ª–∏–Ω–æ–π –¥–æ 10 –±—É–∫–≤) –¥–ª—è –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã.");
                return false;
            }

            shuffleArray(activeSimpleQA);
            shuffleArray(activeComplexQA);

            const selectedSimple = activeSimpleQA.slice(0, NUM_SIMPLE_QUESTIONS);
            const selectedComplex = activeComplexQA.slice(0, NUM_COMPLEX_QUESTIONS);
            
            CURRENT_QUIZ_QA_LIST = [...selectedSimple, ...selectedComplex].map((item, index) => ({
                question: item.q,
                answer: item.a.toUpperCase().replace(/\s+/g, ''),
                originalAnswer: item.a,
                id: `question-${index}-${item.a.toUpperCase().replace(/\s+/g, '').replace(/[^A-Z–ê-–Ø0-9]/ig, '')}`, 
                found: false,
                cells: [] 
            }));
            shuffleArray(CURRENT_QUIZ_QA_LIST); 
            console.log("Selected questions for this quiz:", CURRENT_QUIZ_QA_LIST.map(q => q.originalAnswer));
            return true;
        }

        function determineGridSize() {
            let maxLength = 0;
            if (CURRENT_QUIZ_QA_LIST.length > 0) {
                CURRENT_QUIZ_QA_LIST.forEach(qa => {
                    if (qa.answer.length > maxLength) {
                        maxLength = qa.answer.length;
                    }
                });
            } else {
                GRID_ROWS = MIN_GRID_DIMENSION;
                GRID_COLS = MIN_GRID_DIMENSION;
                console.log(`No questions selected, defaulting grid to ${GRID_ROWS}x${GRID_COLS}`);
                return;
            }
            
            let dimension;
             if (maxLength <= 7) { 
                dimension = MIN_GRID_DIMENSION; 
            } else if (maxLength <= 9) { 
                dimension = Math.max(MIN_GRID_DIMENSION, maxLength + 2); 
            } else { 
                dimension = Math.max(MIN_GRID_DIMENSION, maxLength + 1); 
            }
            dimension = Math.min(dimension, MAX_GRID_DIMENSION); 

            GRID_ROWS = dimension;
            GRID_COLS = dimension;
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —è—á–µ–µ–∫
            document.documentElement.style.setProperty('--grid-cols', GRID_COLS);
            console.log(`Determined grid size: ${GRID_ROWS}x${GRID_COLS} (maxLengthWord: ${maxLength})`);
        }
        
        function resetGame() {
            selectedCells = [];
            placedWordsData = [];
            CURRENT_QUIZ_QA_LIST = [];
            document.getElementById('win-message').style.display = 'none';
            
            const gridTable = document.getElementById('letter-grid');
            if (gridTable) gridTable.innerHTML = '';
            
            const questionsUl = document.getElementById('questions-list');
            if (questionsUl) questionsUl.innerHTML = '';
            
            initGame();
        }

        function initGame() {
            console.log("Initializing new game...");
            if (!selectQuizQuestions()) {
                const gridTable = document.getElementById('letter-grid');
                if (gridTable) gridTable.innerHTML = '<tr><td>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤.</td></tr>';
                const questionsUl = document.getElementById('questions-list');
                if (questionsUl) questionsUl.innerHTML = '<li>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ —Å–ø–∏—Å–∫–∏ —Å–ª–æ–≤.</li>';
                document.getElementById('game-container').style.display = 'none';
                return;
            }
            document.getElementById('game-container').style.display = 'flex';


            if (CURRENT_QUIZ_QA_LIST.length === 0) {
                alert("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∏–≥—Ä—ã –ø—É—Å—Ç –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞.");
                return;
            }

            determineGridSize();
            prepareGridData();
            renderGrid();
            renderQuestions();

            if (placedWordsData.length < CURRENT_QUIZ_QA_LIST.length) {
                 console.warn(`Could only place ${placedWordsData.length} out of ${CURRENT_QUIZ_QA_LIST.length} selected words. Grid: ${GRID_ROWS}x${GRID_COLS}.`);
            }
            if (placedWordsData.length === 0 && CURRENT_QUIZ_QA_LIST.length > 0) {
                 console.error("CRITICAL: No words were placed from the selected quiz words.");
                 alert("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –Ω–∞ —Å–µ—Ç–∫–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–æ–≤–∞.");
            }
        }

        function getRandomLetter() {
            return alphabet[Math.floor(Math.random() * alphabet.length)];
        }

        function prepareGridData() {
            grid = Array(GRID_ROWS).fill(null).map(() => Array(GRID_COLS).fill(null));
            placedWordsData = []; 

            const wordsToPlaceThisTurn = [...CURRENT_QUIZ_QA_LIST].sort((a, b) => b.answer.length - a.answer.length);

            wordsToPlaceThisTurn.forEach(qaItem => {
                const word = qaItem.answer;
                if (word.length > GRID_COLS && word.length > GRID_ROWS) {
                     console.warn(`Word "${word}" (len ${word.length}) might be too long for grid ${GRID_ROWS}x${GRID_COLS}. Checking H/V fit.`);
                }

                let placed = false;
                for (let attempt = 0; attempt < MAX_PLACEMENT_ATTEMPTS_PER_WORD && !placed; attempt++) {
                    const direction = Math.random() < 0.5 ? 'horizontal' : 'vertical';
                    let r_start, c_start;
                    let wordCellsCoords = [];

                    if (direction === 'horizontal') {
                        if (word.length > GRID_COLS) continue; 
                        r_start = Math.floor(Math.random() * GRID_ROWS);
                        c_start = Math.floor(Math.random() * (GRID_COLS - word.length + 1));
                    } else { 
                        if (word.length > GRID_ROWS) continue; 
                        r_start = Math.floor(Math.random() * (GRID_ROWS - word.length + 1));
                        c_start = Math.floor(Math.random() * GRID_COLS);
                    }

                    let canPlace = true;
                    for (let i = 0; i < word.length; i++) {
                        const curR = direction === 'horizontal' ? r_start : r_start + i;
                        const curC = direction === 'horizontal' ? c_start + i : c_start;
                        
                        if (grid[curR][curC] !== null && grid[curR][curC] !== word[i]) {
                            canPlace = false;
                            break;
                        }
                    }

                    if (canPlace) {
                        for (let i = 0; i < word.length; i++) {
                            const curR = direction === 'horizontal' ? r_start : r_start + i;
                            const curC = direction === 'horizontal' ? c_start + i : c_start;
                            grid[curR][curC] = word[i];
                            wordCellsCoords.push({ r: curR, c: curC });
                        }
                        
                        const placedWordEntry = {...qaItem, cells: wordCellsCoords, direction: direction, found: false};
                        placedWordsData.push(placedWordEntry);
                        placed = true;
                    }
                }
                if (!placed) {
                    console.warn(`Could not place word: "${word}" (len ${word.length}) after ${MAX_PLACEMENT_ATTEMPTS_PER_WORD} attempts on ${GRID_ROWS}x${GRID_COLS} grid.`);
                }
            });

            for (let r_fill = 0; r_fill < GRID_ROWS; r_fill++) {
                for (let c_fill = 0; c_fill < GRID_COLS; c_fill++) {
                    if (grid[r_fill][c_fill] === null) {
                        grid[r_fill][c_fill] = getRandomLetter();
                    }
                }
            }
        }

        function renderGrid() {
            const gridTable = document.getElementById('letter-grid');
            gridTable.innerHTML = ''; 
            let baseCellSize = 30; // –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è 10x10 –∏–ª–∏ –º–µ–Ω—å—à–µ

            // –ï—Å–ª–∏ —Å–µ—Ç–∫–∞ –±–æ–ª—å—à–µ 10, –Ω–µ–º–Ω–æ–≥–æ —É–º–µ–Ω—å—à–∞–µ–º —è—á–µ–π–∫–∏,
            // –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ, —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –æ—Å—Ç–∞–≤–∞–ª—Å—è —á–∏—Ç–∞–µ–º—ã–º.
            // –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π calc –≤ CSS @media query –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –±—É–¥–µ—Ç –∏–º–µ—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç–∞–º.
            if (GRID_COLS > 10) {
                baseCellSize = 28;
            }
             if (GRID_COLS > 12) { // –ú–∞–∫—Å–∏–º—É–º 12 —É –Ω–∞—Å, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
                baseCellSize = 26;
            }


            for (let r_render = 0; r_render < GRID_ROWS; r_render++) {
                const tr = document.createElement('tr');
                for (let c_render = 0; c_render < GRID_COLS; c_render++) {
                    const td = document.createElement('td');
                    td.textContent = grid[r_render][c_render];
                    td.dataset.r = r_render;
                    td.dataset.c = c_render;
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ. –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –±—É–¥–µ—Ç CSS calc.
                    td.style.width = `${baseCellSize}px`;
                    td.style.height = `${baseCellSize}px`;
                    td.style.fontSize = `${Math.max(10, baseCellSize - 12)}px`; 
                    td.addEventListener('click', handleCellClick);
                    tr.appendChild(td);
                }
                gridTable.appendChild(tr);
            }
        }

        function renderQuestions() {
            const questionsUl = document.getElementById('questions-list');
            questionsUl.innerHTML = '';
            
            const placedAnswersMap = new Map(placedWordsData.map(pwd => [pwd.answer, pwd]));
            let questionNumber = 1;

            CURRENT_QUIZ_QA_LIST.forEach(quizQaItem => {
                const li = document.createElement('li');
                li.textContent = `${questionNumber}. ${quizQaItem.question}`;
                li.id = quizQaItem.id;

                const placedVersion = placedAnswersMap.get(quizQaItem.answer);
                if (placedVersion && placedVersion.found) {
                    li.classList.add('question-found');
                } else if (CURRENT_QUIZ_QA_LIST.length > 0 && !placedVersion) { 
                     li.classList.add('not-placed');
                     li.title = "–û—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –Ω–∞ —Å–µ—Ç–∫–µ.";
                }
                questionsUl.appendChild(li);
                questionNumber++;
            });

            if (CURRENT_QUIZ_QA_LIST.length > 0 && placedWordsData.length === 0 && questionsUl.children.length > 0) {
                 const firstLi = questionsUl.firstChild;
                 if (firstLi) {
                    const errorLi = document.createElement('li');
                    errorLi.textContent = "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å–ª–æ–≤–∞ –¥–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ.";
                    errorLi.style.color = "orange";
                    questionsUl.insertBefore(errorLi, firstLi);
                 }
            } else if (CURRENT_QUIZ_QA_LIST.length === 0) {
                 questionsUl.innerHTML = "<li>–ù–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</li>";
            }
        }
        
        function handleCellClick(event) {
            const clickedTd = event.target;
            if (document.getElementById('win-message').style.display === 'block' || 
               (CURRENT_QUIZ_QA_LIST.length > 0 && placedWordsData.length === 0) ) {
                return;
            }

            const r_click = parseInt(clickedTd.dataset.r);
            const c_click = parseInt(clickedTd.dataset.c);

            const cellIndexInSelection = selectedCells.findIndex(cell => cell.td === clickedTd);

            if (cellIndexInSelection > -1) {
                clickedTd.classList.remove('selected');
                selectedCells.splice(cellIndexInSelection, 1);
            } else {
                clickedTd.classList.add('selected');
                selectedCells.push({ td: clickedTd, r: r_click, c: c_click, letter: clickedTd.textContent });
            }
            checkSelectedWord();
        }

        function getSubsets(array, size) {
            const result = [];
            const temp = [];
            function findSubsetsRecursive(start) {
                if (temp.length === size) { result.push([...temp]); return; }
                if (start === array.length) { return; }
                temp.push(array[start]);
                findSubsetsRecursive(start + 1);
                temp.pop();
                findSubsetsRecursive(start + 1);
            }
            findSubsetsRecursive(0);
            return result;
        }

        function checkSelectedWord() {
            if (selectedCells.length === 0 || placedWordsData.length === 0) return;
            
            for (const wordData of placedWordsData) {
                if (wordData.found) continue;

                const targetWordString = wordData.answer;
                const targetWordCellsOnGrid = wordData.cells; 

                if (selectedCells.length < targetWordString.length) continue;

                const potentialSubsets = getSubsets(selectedCells, targetWordString.length);

                for (const subset of potentialSubsets) {
                    const subsetCoordsCanonical = subset.map(sc => `${sc.r},${sc.c}`).sort().join(';');
                    const targetWordCellsCanonical = targetWordCellsOnGrid.map(tc => `${tc.r},${tc.c}`).sort().join(';');

                    if (subsetCoordsCanonical === targetWordCellsCanonical) {
                        let formedWordFromSubset = "";
                        let lettersAreCorrect = true;
                        for (const targetGridCell of targetWordCellsOnGrid) {
                            const matchingCellInSubset = subset.find(subCell => subCell.r === targetGridCell.r && subCell.c === targetGridCell.c);
                            if (matchingCellInSubset) {
                                formedWordFromSubset += matchingCellInSubset.letter;
                            } else { lettersAreCorrect = false; break; }
                        }
                        
                        if (lettersAreCorrect && (formedWordFromSubset === targetWordString || formedWordFromSubset.split('').reverse().join('') === targetWordString)) {
                            wordData.found = true; 

                            subset.forEach(cellObj => {
                                cellObj.td.classList.remove('selected');
                                cellObj.td.classList.add('found');
                            });

                            selectedCells.forEach(originalCellObj => {
                                if (!subset.some(subCell => subCell.td === originalCellObj.td)) {
                                    originalCellObj.td.classList.remove('selected');
                                }
                            });
                            
                            const questionLi = document.getElementById(wordData.id);
                            if (questionLi) {
                                questionLi.classList.remove('not-placed'); 
                                questionLi.classList.add('question-found');
                                questionLi.title = ""; 
                            } else { console.warn("Could not find LI for ID:", wordData.id); }
                            
                            selectedCells = []; 
                            checkWinCondition();
                            return; 
                        }
                    }
                } 
            } 
        }
        
        function checkWinCondition() {
            if (placedWordsData.length === 0 && CURRENT_QUIZ_QA_LIST.length > 0) { 
                return;
            }
            const allPlacedWordsFound = placedWordsData.length > 0 && placedWordsData.every(word => word.found);
            
            if (allPlacedWordsFound) {
                const winMessageDiv = document.getElementById('win-message');
                winMessageDiv.style.display = 'block';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initGame();
            document.getElementById('restart-button').addEventListener('click', resetGame);
        });

    </script>
</body>
</html>